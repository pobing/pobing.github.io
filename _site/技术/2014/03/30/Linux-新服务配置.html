<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Linux 新服务配置</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">
        <link rel="stylesheet" href="/css/layout.css">

        <!-- google cse -->
        <script type="text/javascript" src="/javascript/google.cse.js"></script>

    </head>
    <body>

        <div class="site">

          <div class="header">
            <h1 class="title"><a href="/">Pobing's Blog</a></h1>
            <a class="extra" href="/">首页</a>
            <a class="extra" href="/page/read.html">阅读</a>
            <a class="extra" href="/feed.xml">Rss</a>

           <gcse:search></gcse:search>


          </div>

          <h2>Linux 新服务配置</h2>
<p class="meta">30 Mar 2014
<!--   |
 -->
</p>

<div class="post">
<p>linux 版本 ubuntu12.04 x86</p>

<p>首次登录：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">ssh root@x.x.x.x
</code></pre></div>
<p>修改root用户密码：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">passwd
</code></pre></div>
<p>创建新用户组（admin组）：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">addgroup admin
</code></pre></div>
<p>添加新用户：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">useradd -d /home/bill -s /bin/bash -m bill

＃参数d指定用户的主目录，参数s指定用户的shell，参数m表示如果该目录不存在，则创建该目录
</code></pre></div>
<p>设置新用户的密码</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">passwd bill
</code></pre></div>
<p>将新用户（bill）添加到用户组（admin）</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">usermod -a -G admin bill
</code></pre></div>
<p>为新用户设定权限</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">visudo #visudo命令会打开sudo设置文件/etc/sudoers

root    ALL=(ALL:ALL) ALL
bill    ALL=(ALL:ALL) ALL  #为bill 用户设定 sudo 权限
</code></pre></div>
<p>修改默认服务器 ssh 端口，1025 － 65536 之间的任意整数,我们设置端口 58404</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">sudo cp /etc/ssh/sshd_config ~  # 备份 sshd_config 文件
sudo vi /etc/ssh/sshd_config


Port 58404
</code></pre></div>
<p>禁止root 用户登录</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">Protocol 2

PermitRootLogin no
PermitEmptyPasswords no
PasswordAuthentication no

RSAAuthentication yes
PubkeyAuthentication yes
AuthorizedKeysFile .ssh/authorized_keys

UseDNS no


sudo  passwd -l root # 禁用 root 账号
</code></pre></div>
<p>指定允许登录的用户：</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">AllowUsers bill
</code></pre></div>
<p>改变authorized_keys文件的权限</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">sudo chmod 600 ~/.ssh/authorized_keys &amp;&amp; chmod 700 ~/.ssh/
</code></pre></div>
<p>重启SSHD</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">sudo service ssh restart

//或者

sudo /etc/init.d/ssh restart
</code></pre></div>
<p>ruby install</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">sudo apt-get install curl

curl -L get.rvm.io | bash -s stablesource ~/.rvm/scripts/rvm

rvm requirements

rvm install 2.0
rvm use 2.0
ruby -v
rvm --default use 2.0
gem install rails -v 3.2.16
</code></pre></div>
<p>apache,mysql,phpmyadmin</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">sudo apt-get install mysql-server
sudo apt-get install libmysqlclient-dev
mysql_config —socket # config sock
sudo apt-get install apache2
sudo apt-get install phpmyadmin
</code></pre></div>
<p>git</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">git-core
ssh-keygen -t rsa
</code></pre></div>
<p>nginx</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">sudo apt-get install nginx
</code></pre></div>
<p>memcached</p>

<ul>
<li>安装</li>
</ul>
<div class="highlight"><pre><code class="text language-text" data-lang="text">sudo apt-get install memcached
</code></pre></div>
<ul>
<li>启动服务</li>
</ul>
<div class="highlight"><pre><code class="text language-text" data-lang="text">memcached -d -m 50 -p 11011 -u memcache -l 127.0.0.1

常用memcache启动参数介绍:

-d：以daemon的方式在后台启动运行一个守护进程
-m：分配给Memcache使用的最大内存数量，单位是MB，默认是64MB
-u：设定运行Memcache的用户（memcache默认不允许以root用户登录）
-l：监听的服务器IP地址
-p：设置Memcache监听的TCP端口，默认是11211(p为小写)
-c：设置最大并发连接数，默认是1024
-P：设置保存Memcache的pid文件路径(P为大写)
-h：显示帮助
</code></pre></div>
<ul>
<li>关闭服务</li>
</ul>
<div class="highlight"><pre><code class="text language-text" data-lang="text">kill -9 memcache的进程ID
</code></pre></div>
<p>Mysql create user and Grant Permissions</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">user mysql;
create user &#39;rabel&#39;@&#39;localhost&#39; identified by &#39;password&#39;;
GRANT ALL PRIVILEGES ON db_name. * TO &#39;name&#39;@&#39;localhost&#39;;
FLUSH PRIVILEGES;
</code></pre></div>
<p>其他辅助软件</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">sudo apt-get install nodejs
sudo apt-get install imagemagick
</code></pre></div>
<p>ssh 别名登录</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">在本机~/.ssh文件夹下创建config文件，内容如下。

Host s1
HostName 128.199.209.242
User bill
Port 25000

ssh s1 # 新开shell,测试是否可以登录
</code></pre></div>
<p>安装终极Shell zsh</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">sudo apt-get install zsh

wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh

chsh -s /bin/zsh #zsh作为默认shell
</code></pre></div>
<p>参考：</p>

<ul>
<li><a href="http://www.ruanyifeng.com/blog/2014/03/server_setup.html">Linux服务器的初步配置流程</a></li>
<li><a href="http://spenserj.com/blog/2013/07/15/securing-a-linux-server/">securing-a-linux-server</a></li>
<li><a href="http://dhq.me/ubuntu-install-use-memcache">Ubuntu 12.04 LTS下memcache的安装使用</a></li>
</ul>

<p>推荐：</p>

<ul>
<li><a href="http://pobing.info/%E6%8A%80%E6%9C%AF/2014/03/30/ssh-%E5%85%8D%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95.html">ssh 免密码登录</a></li>
<li><a href="http://pobing.info/%E6%8A%80%E6%9C%AF/2014/01/16/%E8%BF%90-git-%E8%A3%B8%E4%BB%93%E5%BA%93%E5%81%9A%E4%BB%A3%E7%A0%81%E9%83%A8%E7%BD%B2.html">使用 git 裸仓库部署项目</a></li>
</ul>

</div>
<p>
<a class="bshareDiv" href="http://www.bshare.cn/share">分享按钮</a><script type="text/javascript" charset="utf-8" src="http://static.bshare.cn/b/buttonLite.js#uuid=0bd5d0c2-23dc-45e3-9d1d-1ebffb059419&style=2&textcolor=#000000&bgcolor=none&bp=qqmb,sinaminiblog,qzone,weixin,facebook,twitter&text=分享"></script>
</p>
<!-- disqus comments -->
<!-- <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'pobingsblog'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a> -->
<!-- disques comments end -->
<!-- Duoshuo Comment BEGIN -->
	<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"pobing"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0]
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- Duoshuo Comment END -->


          <div class="footer">
              <p>
                <a href="https://github.com/pobing">Git hub</a>
                <a href="https://github.com/pobing">Twitter</a>
                <a href="mailto:cn.jdong@gmail.com">Contact</a>
              </p>
          </div>
        </div>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

          ga('create', 'UA-47369732-1', 'pobing.info');
          ga('send', 'pageview');

        </script>
    </body>
</html>
