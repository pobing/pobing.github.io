---
layout: post
title:  "Linux 新服务配置"
date:   2014-03-30 22:18:11

categories: 技术
---

linux 版本 ubuntu12.04 x86

首次登录：

```
ssh root@x.x.x.x

```

修改root用户密码：

```

passwd

```

创建新用户组（admin组）：

```

addgroup admin

```

添加新用户：

```
useradd -d /home/bill -s /bin/bash -m bill

＃参数d指定用户的主目录，参数s指定用户的shell，参数m表示如果该目录不存在，则创建该目录

```

设置新用户的密码

```

passwd bill

```
将新用户（bill）添加到用户组（admin）

```

usermod -a -G admin bill

```
为新用户设定权限

```
visudo #visudo命令会打开sudo设置文件/etc/sudoers

root    ALL=(ALL:ALL) ALL
bill    ALL=(ALL:ALL) ALL  #为bill 用户设定 sudo 权限

```
修改默认服务器 ssh 端口，1025 － 65536 之间的任意整数,我们设置端口 58404

```
sudo cp /etc/ssh/sshd_config ~  # 备份 sshd_config 文件
sudo vi /etc/ssh/sshd_config


Port 58404

```

禁止root 用户登录

```

Protocol 2

PermitRootLogin no
PermitEmptyPasswords no
PasswordAuthentication no

RSAAuthentication yes
PubkeyAuthentication yes
AuthorizedKeysFile .ssh/authorized_keys

UseDNS no


sudo  passwd -l root # 禁用 root 账号


```

指定允许登录的用户：

```
AllowUsers bill

```

改变authorized_keys文件的权限

```

sudo chmod 600 ~/.ssh/authorized_keys && chmod 700 ~/.ssh/

```

重启SSHD

```
sudo service ssh restart

# 或者

sudo /etc/init.d/ssh restart
```




ruby install

```
sudo apt-get install curl

curl -L get.rvm.io | bash -s stablesource ~/.rvm/scripts/rvm

rvm requirements

rvm install 2.0
rvm use 2.0
ruby -v
rvm --default use 2.0
gem install rails -v 3.2.16

```

apache,mysql,phpmyadmin

```
sudo apt-get install mysql-server
sudo apt-get install libmysqlclient-dev
mysql_config —socket # config sock
sudo apt-get install apache2
sudo apt-get install phpmyadmin

```

git

```
git-core
ssh-keygen -t rsa

```

nginx

```
sudo apt-get install nginx

```

other

```
sudo apt-get install nodejs
sudo apt-get install imagemagick

```

Mysql create user and Grant Permissions

```
user mysql;
create user 'rabel'@'localhost' identified by 'password';
GRANT ALL PRIVILEGES ON db_name. * TO 'name'@'localhost';
FLUSH PRIVILEGES;

```

ssh 别名登录

```
在本机~/.ssh文件夹下创建config文件，内容如下。

Host s1
HostName 128.199.209.242
User bill
Port 25000

ssh s1 # 新开shell,测试是否可以登录

```

参考：

* [Linux服务器的初步配置流程](http://www.ruanyifeng.com/blog/2014/03/server_setup.html)
* [securing-a-linux-server](http://spenserj.com/blog/2013/07/15/securing-a-linux-server/)

推荐：

* [ssh 免密码登录](http://pobing.info/技术/2014/03/30/ssh-免密码登录.html)
* [使用 git 裸仓库部署项目](http://pobing.info/%E6%8A%80%E6%9C%AF/2014/01/16/%E8%BF%90-git-%E8%A3%B8%E4%BB%93%E5%BA%93%E5%81%9A%E4%BB%A3%E7%A0%81%E9%83%A8%E7%BD%B2.html)


